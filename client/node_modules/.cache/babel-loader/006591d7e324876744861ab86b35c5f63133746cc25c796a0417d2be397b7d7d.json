{"ast":null,"code":"import React from'react';import{useQuery,useMutation,useQueryClient}from'react-query';import{orders}from'../../services/api';import LoadingSpinner from'../common/LoadingSpinner';import{toast}from'react-toastify';import{format}from'date-fns';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const OrderManagement=()=>{const queryClient=useQueryClient();const{data:allOrders,isLoading,error}=useQuery('allOrders',orders.getAllOrders,{refetchOnWindowFocus:false,onError:error=>{console.error('Error fetching orders:',error);toast.error('Failed to load orders');}});const updateOrderStatus=useMutation(async _ref=>{let{orderId,status}=_ref;const response=await orders.updateStatus(orderId,{status});return response.data;},{onSuccess:()=>{queryClient.invalidateQueries('allOrders');toast.success('Order status updated successfully');},onError:error=>{var _error$response,_error$response$data;console.error('Update status error:',error);toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Failed to update order status');}});if(isLoading)return/*#__PURE__*/_jsx(LoadingSpinner,{});if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-8\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-red-500\",children:[\"Error loading orders: \",error.message]})});}return/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white shadow overflow-hidden sm:rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-4 py-5 sm:px-6\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg leading-6 font-medium text-gray-900\",children:\"All Orders\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"border-t border-gray-200\",children:(allOrders===null||allOrders===void 0?void 0:allOrders.length)>0?/*#__PURE__*/_jsx(\"ul\",{className:\"divide-y divide-gray-200\",children:allOrders.map(order=>{var _order$user;return/*#__PURE__*/_jsx(\"li\",{className:\"px-4 py-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm font-medium text-gray-900\",children:[\"Order ID: \",order._id]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-1 text-sm text-gray-500\",children:[\"Customer: \",((_order$user=order.user)===null||_order$user===void 0?void 0:_order$user.email)||'Unknown']}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-1 text-sm text-gray-500\",children:[\"Date: \",new Date(order.createdAt).toLocaleString()]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-900\",children:\"Items:\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"mt-1 space-y-1\",children:order.items.map(item=>{var _item$product;return/*#__PURE__*/_jsxs(\"li\",{className:\"text-sm text-gray-500\",children:[((_item$product=item.product)===null||_item$product===void 0?void 0:_item$product.name)||'Product Not Found',\" x \",item.quantity,\" - $\",item.price*item.quantity]},item._id);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 text-sm font-medium text-gray-900\",children:[\"Total: $\",order.total]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-6\",children:/*#__PURE__*/_jsxs(\"select\",{value:order.status,onChange:e=>updateOrderStatus.mutate({orderId:order._id,status:e.target.value}),className:\"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"pending\",children:\"Pending\"}),/*#__PURE__*/_jsx(\"option\",{value:\"processing\",children:\"Processing\"}),/*#__PURE__*/_jsx(\"option\",{value:\"shipped\",children:\"Shipped\"}),/*#__PURE__*/_jsx(\"option\",{value:\"delivered\",children:\"Delivered\"}),/*#__PURE__*/_jsx(\"option\",{value:\"cancelled\",children:\"Cancelled\"})]})})]})},order._id);})}):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-8\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"No orders found\"})})})]})});};export default OrderManagement;","map":{"version":3,"names":["React","useQuery","useMutation","useQueryClient","orders","LoadingSpinner","toast","format","jsx","_jsx","jsxs","_jsxs","OrderManagement","queryClient","data","allOrders","isLoading","error","getAllOrders","refetchOnWindowFocus","onError","console","updateOrderStatus","_ref","orderId","status","response","updateStatus","onSuccess","invalidateQueries","success","_error$response","_error$response$data","message","className","children","length","map","order","_order$user","_id","user","email","Date","createdAt","toLocaleString","items","item","_item$product","product","name","quantity","price","total","value","onChange","e","mutate","target"],"sources":["C:/Users/GAYATRI/Desktop/project/client/src/components/Admin/OrderManagement.jsx"],"sourcesContent":["import React from 'react';\r\nimport { useQuery, useMutation, useQueryClient } from 'react-query';\r\nimport { orders } from '../../services/api';\r\nimport LoadingSpinner from '../common/LoadingSpinner';\r\nimport { toast } from 'react-toastify';\r\nimport { format } from 'date-fns';\r\n\r\nconst OrderManagement = () => {\r\n  const queryClient = useQueryClient();\r\n  \r\n  const { data: allOrders, isLoading, error } = useQuery(\r\n    'allOrders',\r\n    orders.getAllOrders,\r\n    {\r\n      refetchOnWindowFocus: false,\r\n      onError: (error) => {\r\n        console.error('Error fetching orders:', error);\r\n        toast.error('Failed to load orders');\r\n      }\r\n    }\r\n  );\r\n\r\n  const updateOrderStatus = useMutation(\r\n    async ({ orderId, status }) => {\r\n      const response = await orders.updateStatus(orderId, { status });\r\n      return response.data;\r\n    },\r\n    {\r\n      onSuccess: () => {\r\n        queryClient.invalidateQueries('allOrders');\r\n        toast.success('Order status updated successfully');\r\n      },\r\n      onError: (error) => {\r\n        console.error('Update status error:', error);\r\n        toast.error(error.response?.data?.message || 'Failed to update order status');\r\n      }\r\n    }\r\n  );\r\n\r\n  if (isLoading) return <LoadingSpinner />;\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"text-center py-8\">\r\n        <p className=\"text-red-500\">Error loading orders: {error.message}</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"bg-white shadow overflow-hidden sm:rounded-lg\">\r\n        <div className=\"px-4 py-5 sm:px-6\">\r\n          <h3 className=\"text-lg leading-6 font-medium text-gray-900\">All Orders</h3>\r\n        </div>\r\n        <div className=\"border-t border-gray-200\">\r\n          {allOrders?.length > 0 ? (\r\n            <ul className=\"divide-y divide-gray-200\">\r\n              {allOrders.map((order) => (\r\n                <li key={order._id} className=\"px-4 py-4\">\r\n                  <div className=\"flex justify-between items-start\">\r\n                    <div>\r\n                      <div className=\"text-sm font-medium text-gray-900\">\r\n                        Order ID: {order._id}\r\n                      </div>\r\n                      <div className=\"mt-1 text-sm text-gray-500\">\r\n                        Customer: {order.user?.email || 'Unknown'}\r\n                      </div>\r\n                      <div className=\"mt-1 text-sm text-gray-500\">\r\n                        Date: {new Date(order.createdAt).toLocaleString()}\r\n                      </div>\r\n                      <div className=\"mt-2\">\r\n                        <h4 className=\"text-sm font-medium text-gray-900\">Items:</h4>\r\n                        <ul className=\"mt-1 space-y-1\">\r\n                          {order.items.map((item) => (\r\n                            <li key={item._id} className=\"text-sm text-gray-500\">\r\n                              {item.product?.name || 'Product Not Found'} x {item.quantity} - ${item.price * item.quantity}\r\n                            </li>\r\n                          ))}\r\n                        </ul>\r\n                      </div>\r\n                      <div className=\"mt-2 text-sm font-medium text-gray-900\">\r\n                        Total: ${order.total}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"ml-6\">\r\n                      <select\r\n                        value={order.status}\r\n                        onChange={(e) =>\r\n                          updateOrderStatus.mutate({\r\n                            orderId: order._id,\r\n                            status: e.target.value,\r\n                          })\r\n                        }\r\n                        className=\"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md\"\r\n                      >\r\n                        <option value=\"pending\">Pending</option>\r\n                        <option value=\"processing\">Processing</option>\r\n                        <option value=\"shipped\">Shipped</option>\r\n                        <option value=\"delivered\">Delivered</option>\r\n                        <option value=\"cancelled\">Cancelled</option>\r\n                      </select>\r\n                    </div>\r\n                  </div>\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          ) : (\r\n            <div className=\"text-center py-8\">\r\n              <p className=\"text-gray-500\">No orders found</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OrderManagement; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}